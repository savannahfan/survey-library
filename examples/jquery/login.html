<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="./login/fonts/icomoon/style.css">

    <link rel="stylesheet" href="./login/css/owl.carousel.min.css">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="./login/css/bootstrap.min.css">

    <!-- Style -->
    <link rel="stylesheet" href="./login/css/style.css">

    <script src="https://cdn.jsdelivr.net/npm/js-cookie@2/src/js.cookie.min.js"></script>


    <SCRIPT type=text/javascript>





    /*function submitForm(oFormElement)
    {
      var elLength = document.MyForm.elements.length;

      for (i=0; i<elLength; i++)
      {
        var type = MyForm.elements[i].value;
        alert(type);
      }

      var xhr = new XMLHttpRequest();
      var data=new FormData (oFormElement);

      var success=0;
      xhr.onload = function(){


          if (xhr.responseText=="1"){ //researcher
              window.location.href="./researcher_homepage.html";
              success=1;
          }
          else if(xhr.responseText=="Invalid Username or Password participant" || xhr.responseText=="Invalid Username or Password researcher"){
              alert ("success"+xhr.responseText);

          }
          else{
              window.location.href="./user_homepage.html";
              Cookies.set('researcher_result', xhr.responseText);
              success=1;
          }
      } // success case
      xhr.onerror = function(){ alert ("fail"+xhr.responseText); } // failure case
      xhr.open (oFormElement.method, "https://surveykg.inf.ed.ac.uk/surveykg/login.php", true);
      xhr.send (new FormData (oFormElement));

      if (success==1){
        return true;
      }
      else{
        return false;
      }

    }*/


    function participantCheck() {


          var xhr = new XMLHttpRequest();
          var success=0;
          //var params= "username=aaa&password=aaa";
          var params= "username="+MyForm.elements[0].value+"&password="+MyForm.elements[1].value;
          xhr.open("POST", "https://surveykg.inf.ed.ac.uk/surveykg/login_participant.php", true);
          xhr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");

          xhr.onload = function(){
              if (xhr.responseText=="Invalid Username or Password"){ //researcher
                  alert (xhr.responseText);

              }
              else{
                  window.location.href="./user_homepage.html";
                  Cookies.set('researcher_result', xhr.responseText);
                  Cookies.set('participantId', MyForm.elements[0].value);
                  success=1;
              }
          } // success case
          xhr.onerror = function(){ alert ("fail"+xhr.responseText); } // failure case

          xhr.send (params);

          if (success==1){
            return true;
          }
          else{
            return false;
          }
    }




    function researcherCheck() {


          var xhr = new XMLHttpRequest();
          var success=0;
          var params= "username="+MyForm.elements[0].value+"&password="+MyForm.elements[1].value;
          xhr.open("POST", "https://surveykg.inf.ed.ac.uk/surveykg/login_researcher.php", true);
          xhr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");

          xhr.onload = function(){
              if (xhr.responseText=="Invalid Username or Password"){ //researcher
                  alert (xhr.responseText);

              }
              else{
                  window.location.href="./researcher_homepage.html";
                  Cookies.set('researcherId',MyForm.elements[0].value);
                  success=1;
              }
          } // success case
          xhr.onerror = function(){ alert ("fail"+xhr.responseText); } // failure case


          //xhr.send (document.MyForm.elements);
          xhr.send(params);

          if (success==1){
            return true;
          }
          else{
            return false;
          }

    }

    </SCRIPT>


    <title>Login</title>

  </head>
  <body>



  <div class="content">
    <div class="container">
      <div class="row">
        <div class="col-md-6 order-md-2">
         <img src="../old-college.jpeg" alt="Image" class="img-fluid">
        </div>

        <div class="col-md-6 contents">
          <div class="row justify-content-center">
            <div class="col-md-8">
              <div class="mb-4">
              <h3><strong>KG-based Survey System</strong></h3>
              <p class="mb-4">Welcome to our survey system. Please choose the correct role after filling in the username and password.</p>
            </div>
            <!--<form target="_blank" action="https://surveykg.inf.ed.ac.uk/surveykg/login.php" method="post" onsubmit="return submitForm(this);">-->
            <form name="MyForm" target="_blank" >
              <div class="form-group first">
                <label for="username">Username</label>
                <input type="text" class="form-control" id="username" name="username">

              </div>
              <div class="form-group last mb-4">
                <label for="password">Password</label>
                <input type="password" class="form-control" id="password" name="password">

              </div>

              <div class="d-flex mb-5 align-items-center">
                <label class="control control--checkbox mb-0"><span class="caption">Remember me</span>
                  <input type="checkbox" checked="checked"/>
                  <div class="control__indicator"></div>
                </label>
                <!--<span class="ml-auto"><a href="#" class="forgot-pass">Forgot Password</a></span>-->
              </div>

              <input type="submit"  onclick="return researcherCheck();" id="researcher" value="I AM A RESEARCHER" class="btn text-white btn-block btn-primary"/>
              <input type="submit"  onclick="return participantCheck();" id="participant" value="I AM A PARTICIPANT" class="btn text-white btn-block btn-primary"/>
              <!--<input  type="submit" name="action"  id="researcher" value="I AM A RESEARCHER" class="btn text-white btn-block btn-primary" > -->
              <!--<input  type="submit" name="action"  id="participant" value="I AM A PARTICIPANT" class="btn text-white btn-block btn-primary" > -->


            </form>
            </div>
          </div>

        </div>

      </div>
    </div>
  </div>




    <script src="./login/js/jquery-3.3.1.min.js"></script>
    <script src="./login/js/popper.min.js"></script>
    <script src="./login/js/bootstrap.min.js"></script>
    <script src="./login/js/main.js"></script>
  </body>
</html>
